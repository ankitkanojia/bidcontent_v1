{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"S:\\\\github repo\\\\bidcontent_v1\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\n\nvar _possibleConstructorReturn = require(\"S:\\\\github repo\\\\bidcontent_v1\\\\node_modules\\\\@babel\\\\runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"S:\\\\github repo\\\\bidcontent_v1\\\\node_modules\\\\@babel\\\\runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"S:\\\\github repo\\\\bidcontent_v1\\\\node_modules\\\\@babel\\\\runtime/helpers/inherits\");\n\nvar _wrapNativeSuper = require(\"S:\\\\github repo\\\\bidcontent_v1\\\\node_modules\\\\@babel\\\\runtime/helpers/wrapNativeSuper\");\n\nvar pump = require('pump');\n\nvar bufferStream = require('./buffer-stream');\n\nvar MaxBufferError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(MaxBufferError, _Error);\n\n  function MaxBufferError() {\n    var _this;\n\n    _classCallCheck(this, MaxBufferError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MaxBufferError).call(this, 'maxBuffer exceeded'));\n    _this.name = 'MaxBufferError';\n    return _this;\n  }\n\n  return MaxBufferError;\n}(_wrapNativeSuper(Error));\n\nfunction getStream(inputStream, options) {\n  if (!inputStream) {\n    return Promise.reject(new Error('Expected a stream'));\n  }\n\n  options = Object.assign({\n    maxBuffer: Infinity\n  }, options);\n  var _options = options,\n      maxBuffer = _options.maxBuffer;\n  var stream;\n  return new Promise(function (resolve, reject) {\n    var rejectPromise = function rejectPromise(error) {\n      if (error) {\n        // A null check\n        error.bufferedData = stream.getBufferedValue();\n      }\n\n      reject(error);\n    };\n\n    stream = pump(inputStream, bufferStream(options), function (error) {\n      if (error) {\n        rejectPromise(error);\n        return;\n      }\n\n      resolve();\n    });\n    stream.on('data', function () {\n      if (stream.getBufferedLength() > maxBuffer) {\n        rejectPromise(new MaxBufferError());\n      }\n    });\n  }).then(function () {\n    return stream.getBufferedValue();\n  });\n}\n\nmodule.exports = getStream;\n\nmodule.exports.buffer = function (stream, options) {\n  return getStream(stream, Object.assign({}, options, {\n    encoding: 'buffer'\n  }));\n};\n\nmodule.exports.array = function (stream, options) {\n  return getStream(stream, Object.assign({}, options, {\n    array: true\n  }));\n};\n\nmodule.exports.MaxBufferError = MaxBufferError;","map":null,"metadata":{},"sourceType":"script"}